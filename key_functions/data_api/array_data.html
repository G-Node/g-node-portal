
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Working with Arrays &mdash; g-node-portal v0.6 documentation</title>
    <link rel="stylesheet" href="../../_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="g-node-portal v0.6 documentation" href="../../index.html" />
   
  
  <link media="only screen and (max-device-width: 480px)" href="../../_static/small_flask.css" type= "text/css" rel="stylesheet" />

  </head>
  <body>

<div id="tabhead">
	<div class="logo">

	<!-- HEADER -->
	<div id="header">
		
		<!-- LOGO -->
		<div id="logo">
			<a href="/"><img src="../../_static/logo.gif" alt="G-Node" border="0" /></a>
		</div>
		
		<!-- LOGO PARTNER -->
		<div id="logo_partner">
			<a href="http://www.incf.org/" target="_blank"><img src="../../_static/logopartner.gif" alt="INCF" border="0" /></a>
		</div>

		<!-- KEYVISUAL -->
		<div id="keyvisual">
			<img src="../../_static/default.jpg" alt="" border="0" />
		</div>
    </div>
    </div>
</div>

  
  

    <div id="right_tabs">
        <div class="seitenbreite">
        <ul class="tabs">
          <li><a href="http://www.g-node.org">G-Node Website</a></li>
          <li class="last">
            <a href="https://portal.g-node.org/data/" title="G-NODE PORTAL">Back to the Portal</a>
          </li>
        </ul>
        </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="working-with-arrays">
<h1>Working with Arrays<a class="headerlink" href="#working-with-arrays" title="Permalink to this headline">¶</a></h1>
<p>This section is about objects that have any data associated with them. It provides details on how to handle the data - how to create a new object, how to access related data, what are the possibilities when making data queries.</p>
<div class="section" id="data-is-stored-in-files">
<h2>Data is stored in Files<a class="headerlink" href="#data-is-stored-in-files" title="Permalink to this headline">¶</a></h2>
<p>We use <a class="reference external" href="http://www.hdfgroup.org/HDF5/">HDF5 file format</a> to store any array data. We made several performance tests which showed this is the optimal way of managing large data arrays. Practically that means that for every object, that has an array data associated with it (like <a class="reference internal" href="../terminology.html#analogsignal"><em>AnalogSignal</em></a> or <a class="reference internal" href="../terminology.html#spiketrain"><em>SpikeTrain</em></a>) we store the data in related HDF5 file. In order to access the data using the API you basically have to access the associated file. There are several format options, explained in the <a class="reference internal" href="#data-format"><em>sections below</em></a>.</p>
<div class="section" id="create-data-related-object">
<span id="create-array-routine"></span><h3>Create data-related object<a class="headerlink" href="#create-data-related-object" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>So the routine to create a new data-associated object has actually two steps:</dt>
<dd><ul class="first last simple">
<li>you upload the file with the data, the file is being validated on the server</li>
<li>you create your object using <a class="reference internal" href="principles.html#common-create"><em>standard POST request</em></a> where, inside the body, you mention the link to the created datafile</li>
</ul>
</dd>
</dl>
<p>In between it&#8217;s recommended to wait until the file is completely uploaded and validated. The requirements to the uploaded file in order it can be later used with <a class="reference internal" href="electrophysiology.html#array-upload-note"><em>data-related objects</em></a> is provided in the <a class="reference internal" href="#data-format"><em>HDF5 section</em></a>.</p>
<p>To check the file is correct and can be assigned to a <a class="reference internal" href="electrophysiology.html#array-upload-note"><em>data-related object</em></a>, you may request the uploaded file information (<a class="reference internal" href="principles.html#get-single-object"><em>usual GET request</em></a>) and make sure it has appropriate type (type = 5 in particular for files with arrays, see <a class="reference internal" href="files.html#file-types"><em>file types</em></a>).</p>
</div>
<div class="section" id="access-data">
<h3>Access data<a class="headerlink" href="#access-data" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Accessing the data basically also suggests you send a couple of HTTP requests:</dt>
<dd><ul class="first last simple">
<li>at first you get the object in JSON with reference to the datafile,</li>
<li>at second you access the datafile directly using the reference from previous response (a detailed example is in the next section).</li>
</ul>
</dd>
</dl>
<p>This routine is needed to mitigate the unefficiency of transferring data, for instance, directly inside one full JSON response body assembled for several objects, which increases the amount of data transferred and leads to a high server and client load. In cases with large data arrays, which are typical for neuroscience, efficient data access is crucial.</p>
</div>
</div>
<div class="section" id="partial-data-requests">
<h2>Partial data requests<a class="headerlink" href="#partial-data-requests" title="Permalink to this headline">¶</a></h2>
<p>All <a class="reference internal" href="electrophysiology.html#array-upload-note"><em>data-related objects</em></a>, which represent electrophysiological signals, support partial data requests. In fact, that means you may request only a slice of the data array if needed and avoid downloading of the whole signal, which could be very practical when accessing large data arrays. This works for both single and multiple object requests. Use the following GET request parameters to configure partial data response:</p>
<blockquote>
<div><ul class="simple">
<li>[start_time] - start time of the required range (calculated using the same time unit as the t_start of the signal)</li>
<li>[end_time] - end time of the required range (calculated using the same time unit as the t_start of the signal)</li>
<li>[duration] - duration of the required range (calculated using the same time unit as the t_start of the signal)</li>
<li>[start_index] - start index of the required datarange (an index of the starting datapoint)</li>
<li>[end_index] - end index of the required range (an index of the end datapoint)</li>
<li>[samples_count] - number of points of the required range (an index of the end datapoint)</li>
<li>[downsample] - number of datapoints. This parameter is used to indicate whether downsampling is needed. The downsampling is applied on top of the selected data range using other parameters (if specified).</li>
</ul>
</div></blockquote>
<p><em>Note. Some reasonable combinations of these parameters (like &#8216;start_time&#8217; and &#8216;duration&#8217; or &#8216;start_index&#8217; and &#8216;end_time&#8217; will return a correct response. Using redundant number of parameters will lead to their disregard, useless combinations may throw a 400 bad request.</em></p>
<p>For example, send the following GET request</p>
<blockquote>
<div><div class="highlight-python"><pre>Request: GET /electrophysiology/analogsignal/11/?start_time=50&amp;duration=100&amp;downsample=20</pre>
</div>
</div></blockquote>
<p>to get the 100ms time window of the <a class="reference internal" href="../terminology.html#analogsignal"><em>AnalogSignal</em></a> with ID = 11 starting from 50ms, downsampled from to 20 datapoints, first request the object:</p>
<blockquote>
<div><div class="highlight-python"><pre>HTTP SUCCESS (200)

{
...
"selected": [
    {
    "fields": {
        "id": 11,
        "name": "LFP FIX Signal-10, size: 2000",
        "signal": {
            "units": "mv",
            "data": "/datafiles/2177?start_index=1000&amp;end_index=3001&amp;downsample=20"
        },
        "t_start": {
            "units": "ms",
            "data": 50
        },
        "sampling_rate": {
            "units": "hz",
            "data": 20000
        },
        "guid": "00ec575f2f20eae37907d1927afaabe09bab2b39",
        ...
    },
    "model": "neo_api.analogsignal",
    "permalink": "/electrophysiology/analogsignal/11"
    }
],
...
}</pre>
</div>
</div></blockquote>
<p>and then request an appropriate data slice using the link in the response (in this case &#8220;/datafiles/2177?start_index=1000&amp;end_index=3001&amp;downsample=20&#8221;).</p>
<p>Notice that the &#8220;t_start&#8221; data field in the response has a data value of 3, indicating the start of the requested part of the array, but not the full original array.</p>
</div>
<div class="section" id="data-in-different-formats">
<span id="data-format"></span><h2>Data in different formats<a class="headerlink" href="#data-in-different-formats" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>You may request data in different format, depending on what better is suitable for your client application. Up to the moment we support the following formats:</dt>
<dd><ul class="first last simple">
<li>HDF5</li>
<li>JSON</li>
</ul>
</dd>
</dl>
<div class="section" id="hdf5">
<h3>HDF5<a class="headerlink" href="#hdf5" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>By default you get back data as an HDF5 file. Inside the file, an appropriate array is stored in the root of the HDF5 hierarchy (normally there shouldn&#8217;t be any other object in the file, so just accessing the first object should return a correct array); an array should have a name equal to its <a class="reference internal" href="../terminology.html#common-terms"><em>global ID</em></a>. To summarize:</dt>
<dd><ul class="first last simple">
<li>it is an HDF5 file</li>
<li>an array is in the root (&#8220;/&#8221;)</li>
<li>the dimensions of the array are compatible with the <a class="reference internal" href="../terminology.html#ephys-objects"><em>object specification</em></a></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="json">
<h3>JSON<a class="headerlink" href="#json" title="Permalink to this headline">¶</a></h3>
<p>In order to request different format, provide &#8220;format&#8221; parameter in the GET request. For the moment ther is only one alternative format - JSON, so just provide &#8220;format=json&#8221; in the request GET to get back data in the response body as a list of values (be aware the response is a simple string).</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Working with Arrays</a><ul>
<li><a class="reference internal" href="#data-is-stored-in-files">Data is stored in Files</a><ul>
<li><a class="reference internal" href="#create-data-related-object">Create data-related object</a></li>
<li><a class="reference internal" href="#access-data">Access data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#partial-data-requests">Partial data requests</a></li>
<li><a class="reference internal" href="#data-in-different-formats">Data in different formats</a><ul>
<li><a class="reference internal" href="#hdf5">HDF5</a></li>
<li><a class="reference internal" href="#json">JSON</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/key_functions/data_api/array_data.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    <h2>Questions/Feedback</h2>
    <p>Having any questions? Got an idea how to improve a service? You're welcome to contact us!<br> Please send your questions/feedback to support-at-g-node.org , we are happy to help!</p>
  </div>
  <div class="footer">
    &copy; Copyright 2011, asobolev.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  
  </body>
</html>